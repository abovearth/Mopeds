{
  "_fv": 47,
  "_type": "procedure",
  "definition": {
    "procedurexml": "<xml xmlns=\"https://developers.google.com/blockly/xml\"><block type=\"event_trigger\" deletable=\"false\" x=\"0\" y=\"0\"><field name=\"trigger\">no_ext_trigger</field><next><block type=\"entity_close_gui\"><value name=\"entity\"><block type=\"source_entity_from_deps\"></block></value><next><block type=\"controls_if\"><mutation else=\"1\"></mutation><value name=\"IF0\"><block type=\"compare_mcitems\"><value name=\"a\"><block type=\"itemstack_to_mcitem\"></block></value><value name=\"b\"><block type=\"mcitem_all\"><field name=\"value\">CUSTOM:MopedKey</field></block></value></block></value><statement name=\"DO0\"><block type=\"java_code\"><field name=\"CODE\">if (sourceentity instanceof ServerPlayer serverPlayer) {&amp;#10;\t\t\t\tNetworkHooks.openScreen(serverPlayer, new MenuProvider() {&amp;#10;\t\t\t\t\t@Override&amp;#10;\t\t\t\t\tpublic Component getDisplayName() {&amp;#10;\t\t\t\t\t\treturn Component.literal(\"Copper Moped\");&amp;#10;\t\t\t\t\t}&amp;#10;&amp;#10;\t\t\t\t\t@Override&amp;#10;\t\t\t\t\tpublic AbstractContainerMenu createMenu(int id, Inventory inventory, Player player) {&amp;#10;\t\t\t\t\t\tFriendlyByteBuf packetBuffer = new FriendlyByteBuf(Unpooled.buffer());&amp;#10;\t\t\t\t\t\tpacketBuffer.writeBlockPos(sourceentity.blockPosition());&amp;#10;\t\t\t\t\t\tpacketBuffer.writeByte(0);&amp;#10;\t\t\t\t\t\tpacketBuffer.writeVarInt(entity.getId());&amp;#10;\t\t\t\t\t\treturn new MopedGUIMenu(id, inventory, packetBuffer);&amp;#10;\t\t\t\t\t}&amp;#10;\t\t\t\t}, buf -&gt; {&amp;#10;\t\t\t\t\tbuf.writeBlockPos(sourceentity.blockPosition());&amp;#10;\t\t\t\t\tbuf.writeByte(0);&amp;#10;\t\t\t\t\tbuf.writeVarInt(entity.getId());&amp;#10;\t\t\t\t});&amp;#10;\t\t\t}&amp;#10;</field></block></statement><statement name=\"ELSE\"><block type=\"entity_makeride\"><value name=\"sourceentity\"><block type=\"source_entity_from_deps\"></block></value><value name=\"entity\"><block type=\"entity_from_deps\"></block></value></block></statement></block></next></block></next></block><block type=\"entity_open_gui\" x=\"762\" y=\"116\"><field name=\"guiname\">MopedGUI</field><value name=\"entity\"><block type=\"source_entity_from_deps\"></block></value><value name=\"x\"><block type=\"coord_x\"></block></value><value name=\"y\"><block type=\"coord_y\"></block></value><value name=\"z\"><block type=\"coord_z\"></block></value></block><block type=\"java_code\" x=\"713\" y=\"672\"><field name=\"CODE\">@Override&amp;#10;\tpublic void travel(Vec3 dir) {&amp;#10;\t\tEntity entity = this.getPassengers().isEmpty() ? null : (Entity) this.getPassengers().get(0);&amp;#10;\t\tif (this.isVehicle()) {&amp;#10;\t\t\tthis.setYRot(entity.getYRot());&amp;#10;\t\t\tthis.yRotO = this.getYRot();&amp;#10;\t\t\tthis.setXRot(entity.getXRot() * 0.5F);&amp;#10;\t\t\tthis.setRot(this.getYRot(), this.getXRot());&amp;#10;\t\t\tthis.yBodyRot = entity.getYRot();&amp;#10;\t\t\tthis.yHeadRot = entity.getYRot();&amp;#10;\t\t\tthis.setMaxUpStep(1.0F);&amp;#10;\t\t\tif (entity instanceof LivingEntity passenger) {&amp;#10;\t\t\t\tthis.setSpeed((float) this.getAttributeValue(Attributes.MOVEMENT_SPEED));&amp;#10;\t\t\t\tfloat forward = passenger.zza;&amp;#10;\t\t\t\tfloat strafe = 0;&amp;#10;\t\t\t\tsuper.travel(new Vec3(strafe, 0, forward));&amp;#10;\t\t\t}&amp;#10;\t\t\tdouble d1 = this.getX() - this.xo;&amp;#10;\t\t\tdouble d0 = this.getZ() - this.zo;&amp;#10;\t\t\tfloat f1 = (float) Math.sqrt(d1 * d1 + d0 * d0) * 4;&amp;#10;\t\t\tif (f1 &gt; 1.0F)&amp;#10;\t\t\t\tf1 = 1.0F;&amp;#10;\t\t\tthis.walkAnimation.setSpeed(this.walkAnimation.speed() + (f1 - this.walkAnimation.speed()) * 0.4F);&amp;#10;\t\t\tthis.walkAnimation.position(this.walkAnimation.position() + this.walkAnimation.speed());&amp;#10;\t\t\tthis.calculateEntityAnimation(true);&amp;#10;\t\t\treturn;&amp;#10;\t\t}&amp;#10;\t\tthis.setMaxUpStep(0.5F);&amp;#10;\t\tsuper.travel(dir);&amp;#10;\t}&amp;#10;</field></block></xml>"
  }
}